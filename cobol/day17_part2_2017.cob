
       IDENTIFICATION DIVISION.
       PROGRAM-ID. SPINLOCK-SIMULATOR.
       AUTHOR. EXPERT PROGRAMMER.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT INPUT-FILE ASSIGN TO 'input.txt'.

       DATA DIVISION.
       FILE SECTION.
       FD INPUT-FILE.
       01 INPUT-RECORD.
           05 INPUT-DATA PIC X(10).

       WORKING-STORAGE SECTION.
       01 WS-STEPS             PIC 9(9) VALUE 0.
       01 WS-CURRENT-POS       PIC 9(9) VALUE 0.
       01 WS-VALUE-AFTER-ZERO  PIC 9(9) VALUE 0.
       01 WS-LOOP-COUNTER      PIC 9(9) VALUE 0.
       01 WS-ITERATIONS        PIC 9(9) VALUE 50000000.
       01 WS-TEMP-POS          PIC 9(9) VALUE 0.

       PROCEDURE DIVISION.
       MAIN-PROCEDURE.
           OPEN INPUT INPUT-FILE.
           READ INPUT-FILE.
           CLOSE INPUT-FILE.

           MOVE FUNCTION TRIM(INPUT-DATA) TO WS-STEPS.

           PERFORM VARYING WS-LOOP-COUNTER FROM 1 BY 1 UNTIL
                   WS-LOOP-COUNTER > WS-ITERATIONS
               COMPUTE WS-TEMP-POS = WS-CURRENT-POS + WS-STEPS
               COMPUTE WS-CURRENT-POS = FUNCTION MOD(WS-TEMP-POS, WS-LOOP-COUNTER)

               IF WS-CURRENT-POS = 0
                   MOVE WS-LOOP-COUNTER TO WS-VALUE-AFTER-ZERO
               END-IF

               ADD 1 TO WS-CURRENT-POS
           END-PERFORM.

           DISPLAY WS-VALUE-AFTER-ZERO.

           STOP RUN.
