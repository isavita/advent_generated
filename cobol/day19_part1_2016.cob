
       IDENTIFICATION DIVISION.
       PROGRAM-ID. WINNINGELF.
       AUTHOR. EXPERT PROGRAMMER.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT INPUT-FILE ASSIGN TO 'input.txt'.

       DATA DIVISION.
       FILE SECTION.
       FD INPUT-FILE.
       01 INPUT-RECORD PIC X(10).

       WORKING-STORAGE SECTION.
       01 WS-TOTAL-ELVES      PIC 9(10) VALUE 0.
       01 WS-HIGHEST-POWER-OF-TWO PIC 9(10) VALUE 1.
       01 WS-WINNER           PIC 9(10) VALUE 0.

       PROCEDURE DIVISION.
       MAIN-PROCEDURE.
           OPEN INPUT INPUT-FILE.
           READ INPUT-FILE.
           CLOSE INPUT-FILE.

           MOVE FUNCTION NUMVAL(FUNCTION TRIM(INPUT-RECORD)) TO WS-TOTAL-ELVES.

           PERFORM FIND-WINNING-ELF.

           DISPLAY WS-WINNER.

           STOP RUN.

       FIND-WINNING-ELF.
           PERFORM VARYING WS-HIGHEST-POWER-OF-TWO
               FROM 1 BY WS-HIGHEST-POWER-OF-TWO
               UNTIL WS-HIGHEST-POWER-OF-TWO * 2 > WS-TOTAL-ELVES
           END-PERFORM.

           COMPUTE WS-WINNER = (WS-TOTAL-ELVES - WS-HIGHEST-POWER-OF-TWO) * 2 + 1.
